<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Investment Strategy Backtester</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
<div class="container">
    <header>
        <h1>Investment Strategy Backtester</h1>
        <p class="subtitle">Upload custom strategies to test against historical data</p>
    </header>

    <div class="flex-container">
        <div class="control-panel card">
            <h2 class="card-title">Strategy Parameters</h2>

            <div class="form-group">
                <label for="startDate">Start Date</label>
                <input type="date" id="startDate">
            </div>

            <div class="form-group">
                <label for="endDate">End Date</label>
                <input type="date" id="endDate">
            </div>

            <div class="form-group">
                <label for="interval">Trading Interval</label>
                <select id="interval">
                    <option value="daily">Daily</option>
                    <option value="weekly">Weekly</option>
                    <option value="monthly">Monthly</option>
                </select>
            </div>

            <div class="form-group">
                <label for="initialCapital">Initial Capital ($)</label>
                <input type="number" id="initialCapital" value="10000" min="1000" step="1000">
            </div>

            <div class="strategy-upload">
                <div class="strategy-upload-title">Upload Custom Strategy</div>
                <div class="file-input-wrapper">
                    <div class="file-input-label">
                        <span>Click to upload strategy file</span>
                        <input type="file" id="strategyFile" accept=".js">
                    </div>
                    <div class="file-name" id="fileName">No file selected</div>
                </div>

                <div class="strategy-info">
                    <h4>Strategy File Requirements</h4>
                    <p>Your strategy file must export a function with the following signature:</p>
                    <pre><code>function strategy(dataPoint, state) {
  // dataPoint: { date: string, price: number }
  // state: { cash: number, shares: number, position: 'out'|'holding' }

  // Return object:
  return {
    action: 'buy' | 'sell' | 'hold',
    quantity: number // (optional)
  };
}</code></pre>
                </div>
            </div>

            <button id="runBacktest" class="btn">
                Run Backtest
            </button>

            <div id="statusMessage" class="status">Ready to run backtest</div>
        </div>

        <div class="results-panel card">
            <h2 class="card-title">Backtest Results</h2>

            <div class="results-grid">
                <div class="metric-card">
                    <div class="metric-label">Initial Capital</div>
                    <div class="metric-value" id="initialCapitalValue">$10,000</div>
                </div>
                <div class="metric-card">
                    <div class="metric-label">Final Value</div>
                    <div class="metric-value" id="finalValue">$12,450</div>
                </div>
                <div class="metric-card">
                    <div class="metric-label">Profit/Loss</div>
                    <div class="metric-value metric-positive" id="profitLoss">+$2,450</div>
                </div>
                <div class="metric-card">
                    <div class="metric-label">Return</div>
                    <div class="metric-value metric-positive" id="return">24.5%</div>
                </div>
            </div>

            <div class="chart-container">
                <canvas id="performanceChart"></canvas>
            </div>

            <div class="legend">
                <div class="legend-item" data-dataset="0">
                    <div class="legend-color portfolio"></div>
                    <span>Portfolio Value</span>
                </div>
                <div class="legend-item" data-dataset="1">
                    <div class="legend-color stock"></div>
                    <span>Stock Price</span>
                </div>
            </div>

            <h3 style="margin-top: 30px; margin-bottom: 15px;">Trade History</h3>
            <div style="max-height: 300px; overflow-y: auto;">
                <table class="trades-table">
                    <thead>
                    <tr>
                        <th>Date</th>
                        <th>Action</th>
                        <th>Price</th>
                        <th>Shares</th>
                        <th>Value</th>
                    </tr>
                    </thead>
                    <tbody id="tradesTableBody">
                    <!-- Trade data will be populated here -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

<script src="script.js"></script>
</body>
</html>